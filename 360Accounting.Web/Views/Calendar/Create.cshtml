@model _360Accounting.Web.Models.CalendarViewModel

@{
    ViewBag.Title = "Create Calendar";
}

<div class="row">
    <div class="col-lg-12">
        <h3 class="page-header">
            @ViewBag.Title
        </h3>
    </div>
</div>

@using (Html.BeginForm("Create", "Calendar",
FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.ValidationSummary()
    @Html.HiddenFor(m => m.SOBId)

    <div class="col-lg-12">
        
        <div class="col-md-4">
            @Html.LabelFor(m => m.PeriodName)
            @Html.TextBoxFor(m => m.PeriodName, new { @class = "form-control" })
        </div>
        <div class="col-md-4">
            @Html.LabelFor(m => m.PeriodYear)
            @Html.TextBoxFor(m => m.PeriodYear, new { @class = "form-control" })
        </div>
    
        <div class="col-md-4">
            @Html.LabelFor(m => m.PeriodQuarter)
            @Html.TextBoxFor(m => m.PeriodQuarter, new { @class = "form-control" })
        </div>
    
        <div class="col-md-4">
            @Html.LabelFor(m => m.SeqNumber)
            @Html.TextBoxFor(m => m.SeqNumber, new { @readonly = "readonly", @class = "form-control" })
        </div>
    
        <div class="col-md-4">
            @Html.LabelFor(m => m.StartDate)
            @Html.TextBoxFor(m => m.StartDate, new { @class = "form-control" })
        </div>
    
        <div class="col-md-4">
            @Html.LabelFor(m => m.EndDate)
            @Html.TextBoxFor(m => m.EndDate, new { @class = "form-control" })
        </div>

        <div class="form-group">
            <div class="col-md-4">
                @Html.LabelFor(m => m.Adjusting)
                @Html.CheckBoxFor(m => m.Adjusting)
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Save" class="btn btn-default" />
                <input type="button" value="Cancel" class="btn btn-default" id="btnCancel" />
            </div>
        </div>
    </div>
    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")

        <script type="text/javascript">
            $(document).ready(function () {
                $('#btnCancel').click(function () {
                    window.location.href = '@Url.Content("~/Calendar/Index")';
                });

                $('#PeriodYear').change(function () {
                    $.ajax({
                        url: '@Url.Content("~/Calendar/GetPreviousCalendar")',
                        data: {
                            sobId: $('#SOBId').val(),
                            periodYear: $('#PeriodYear').val()
                        },
                        type: 'post',
                        datatype: 'json',
                        error: function (error) { alert("Error Sequence Number fetch.") },
                        success: function (seqNumber) {
                            $('#SeqNumber').val(seqNumber + 1);
                        }
                    });
                });
            });
        </script>
    }
}
